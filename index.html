<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¬å¤ªç¦éŸ³ç”Ÿå‘½è®€ç¶“</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        .container { max-width: 600px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 20px; padding: 20px; }
        .header h1 { font-size: 1.8em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .week-info { background: rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 25px; display: inline-block; font-size: 0.9em; }
        .content-card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); margin-bottom: 20px; }
        .reading-header { border-bottom: 3px solid #667eea; padding-bottom: 15px; margin-bottom: 20px; }
        .part-indicator { display: inline-block; background: #667eea; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.85em; margin-bottom: 15px; }
        .reading-title { font-size: 1.5em; color: #333; margin-bottom: 5px; }
        .reading-meta { color: #666; font-size: 0.9em; }
        .progress-bar { height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; margin: 20px 0; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #667eea, #764ba2); border-radius: 4px; transition: width 0.5s ease; }
        .progress-text { text-align: center; color: #666; font-size: 0.85em; margin-top: 5px; }
        .scripture { background: #f8f9fa; border-left: 4px solid #667eea; padding: 15px 20px; margin: 20px 0; border-radius: 0 10px 10px 0; font-style: italic; color: #555; }
        .scripture-ref { display: block; text-align: right; font-weight: bold; color: #667eea; margin-top: 10px; font-style: normal; }
        .content-text { line-height: 1.8; color: #333; font-size: 1.05em; text-align: justify; }
        .content-text p { margin-bottom: 15px; text-indent: 2em; }
        .navigation { display: flex; justify-content: space-between; gap: 10px; margin-top: 30px; }
        .nav-btn { flex: 1; padding: 15px 20px; border: none; border-radius: 12px; font-size: 1em; cursor: pointer; transition: all 0.3s ease; font-weight: 500; }
        .nav-btn.primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .nav-btn.secondary { background: #f0f0f0; color: #666; }
        .nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .countdown { text-align: center; padding: 20px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 15px; margin-top: 20px; }
        .countdown-title { color: #666; font-size: 0.9em; margin-bottom: 10px; }
        .countdown-time { font-size: 1.3em; color: #667eea; font-weight: bold; }
        .settings-btn { position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: white; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.2); font-size: 1.5em; cursor: pointer; z-index: 100; }
        .settings-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; padding: 20px; }
        .settings-modal.active { display: flex; }
        .settings-content { background: white; border-radius: 20px; padding: 30px; max-width: 400px; width: 100%; max-height: 80vh; overflow-y: auto; }
        .settings-title { font-size: 1.3em; margin-bottom: 20px; color: #333; }
        .setting-item { margin-bottom: 20px; }
        .setting-label { display: block; margin-bottom: 8px; color: #666; font-size: 0.9em; }
        .setting-input { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1em; }
        .close-settings { width: 100%; padding: 15px; background: #667eea; color: white; border: none; border-radius: 10px; font-size: 1em; cursor: pointer; margin-top: 10px; }
        .reading-item { padding: 10px; border-bottom: 1px solid #f0f0f0; cursor: pointer; }
        .reading-item:hover { background: #f8f9fa; }
        .reading-item.current { background: #e3f2fd; border-left: 3px solid #667eea; }
        .reading-item.completed { color: #999; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“– é¦¬å¤ªç¦éŸ³ç”Ÿå‘½è®€ç¶“</h1>
            <div class="week-info" id="weekInfo"></div>
        </div>

        <div class="content-card">
            <div class="reading-header">
                <span class="part-indicator" id="partIndicator"></span>
                <h2 class="reading-title" id="readingTitle"></h2>
                <div class="reading-meta" id="readingMeta"></div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="progressText"></div>

            <div class="scripture" id="scriptureBlock">
                <div id="scriptureText"></div>
                <span class="scripture-ref" id="scriptureRef"></span>
            </div>

            <div class="content-text" id="contentText"></div>

            <div class="navigation">
                <button class="nav-btn secondary" id="prevBtn">â† ä¸Šä¸€ç¯‡</button>
                <button class="nav-btn primary" id="nextBtn">ä¸‹ä¸€ç¯‡ â†’</button>
            </div>
        </div>

        <div class="countdown">
            <div class="countdown-title">â° è·é›¢ä¸‹æ¬¡æ›´æ–°é‚„æœ‰</div>
            <div class="countdown-time" id="countdownTime"></div>
        </div>
    </div>

    <button class="settings-btn" id="settingsBtn">âš™ï¸</button>

    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <h3 class="settings-title">âš™ï¸ è¨­å®š</h3>
            <div class="setting-item">
                <label class="setting-label">ğŸ“… é–‹å§‹æ—¥æœŸï¼ˆç¬¬ä¸€é€±çš„é€±ä¸€ï¼‰</label>
                <input type="date" class="setting-input" id="startDateInput">
            </div>
            <div class="setting-item">
                <label class="setting-label">ğŸ“– é–±è®€é€²åº¦</label>
                <div id="readingList" style="max-height: 200px; overflow-y: auto; border: 1px solid #e0e0e0; border-radius: 10px; padding: 10px;"></div>
            </div>
            <button class="close-settings" id="closeSettingsBtn">é—œé–‰</button>
        </div>
    </div>

    <script>
    // ç­‰å¾…DOMå®Œå…¨åŠ è¼‰
document.addEventListener('DOMContentLoaded', function() {
    try {
        console.log('åˆå§‹åŒ–é–‹å§‹...');
        
        // è®€ç¶“æ•¸æ“š
        var readings = [
            {
                title: "ç¬¬1ç¯‡",
                scripture: "å¤ªä¸€1ï½17",
                verses: "ç‹çš„å®¶ä¸–èˆ‡èº«åˆ†ï¼ˆä¸€ï¼‰",
                content: "è–ç¶“ä¹ƒæ˜¯ç¥çš„èªªè©±ï¼Œç‰ æœ‰å…©éƒ¨åˆ†ã€‚åœ¨é ­ä¸€éƒ¨åˆ†ï¼Œå°±æ˜¯èˆŠç´„ï¼Œç¥è—‰è‘—çœ¾ç”³è¨€è€…èªªè©±ï¼›åœ¨ç¬¬äºŒéƒ¨åˆ†ï¼Œå°±æ˜¯æ–°ç´„ï¼Œç¥åœ¨å­è£èªªè©±ã€‚\n\nè–ç¶“æ˜¯ä¸€æœ¬ç”Ÿå‘½çš„æ›¸ã€‚é€™ç”Ÿå‘½ä¸€é»ä¸å·®å°±æ˜¯åŸºç£é€™ä½æ´»çš„äººç‰©ã€‚èˆŠç´„æç¹ªåŸºç£æ˜¯è¦ä¾†çš„ä¸€ä½ï¼›åˆ°äº†æ–°ç´„ï¼Œæ‰€è±«è¨€çš„é€™ä¸€ä½ä¾†äº†ã€‚å› æ­¤ï¼Œæ–°ç´„ä¹ƒæ˜¯èˆŠç´„çš„æ‡‰é©—ã€‚\n\næ–°ç´„é–‹é ­çš„è©±ï¼šå¹¾ä¹æ‰€æœ‰çš„åŸºç£å¾’ï¼Œéƒ½å› æ–°ç´„çš„é ­ä¸€é å—åˆ°å›°æ“¾ã€‚é€™ä¸€é æœ‰å¾ˆå¤šæ‹—å£é›£å¿µçš„åå­—ã€‚ä½†é€™ä¸€é æ˜¯æ–°ç´„çš„é ­ä¸€éƒ¨åˆ†ã€‚ä»»ä½•ä¸€ç¨®è‘—ä½œï¼Œé–‹é ­çš„è©±å’ŒçµæŸçš„è©±éƒ½å¾ˆé‡è¦ã€‚\n\nåŸºç£çš„å®¶è­œç”±ä¸‹åˆ—äº”ç­äººçµ„æˆï¼š\n\nä¸€ã€åˆ—ç¥–\né€™äº›å…ˆç¥–æ˜¯å‰å¤§çš„äººç‰©ï¼Œå…±æœ‰åå››ä»£ã€‚\n\näºŒã€å›ç‹\né€™äº›å›ç‹æ˜¯ç‹æ—ï¼Œä¹Ÿæœ‰åå››ä»£ã€‚\n\nä¸‰ã€å¹³æ°‘ï¼ˆè¢«æ“„èˆ‡æ­¸å›çš„äººï¼‰\nåŸºç£çš„å®¶è­œä¸åƒ…åŒ…æ‹¬é«˜éšå±¤çš„äººï¼Œä¹ŸåŒ…æ‹¬å¹³æ°‘ï¼Œä¸é¡¯è‘—çš„äººï¼Œå°±å¦‚é¦¬åˆ©äºå’Œç´„ç‘Ÿã€‚è²§çª®äººã€å°äººç‰©ä¹ŸåŒ…æ‹¬åœ¨åŸºç£çš„å®¶è­œè£ã€‚\n\nå››ã€å››å€‹å†å«çš„å©¦å¥³\näºç•¶çš„å®¶è­œä¸è¨˜å©¦å¥³ã€‚ä½†åœ¨åŸºç£é€™å€‹ç°¡çŸ­çš„å®¶è­œè£å»é¡Œèµ·äº”å€‹å©¦å¥³ã€‚\n\näº”ã€ä¸€å€‹ç«¥å¥³\nåœ¨é€™å››å€‹å†å«çš„å¥³äººä¹‹å¤–ï¼Œæœ‰ä¸€å€‹ç«¥å¥³å¾ˆçªå‡ºï¼šè€¶ç©Œçš„æ¯è¦ªé¦¬åˆ©äºã€‚",
                scriptureText: "äºä¼¯æ‹‰ç½•ç”Ÿä»¥æ’’ï¼Œä»¥æ’’ç”Ÿé›…å„ï¼Œé›…å„ç”ŸçŒ¶å¤§å’Œä»–çš„å¼Ÿå…„å€‘ã€‚"
            },
            {
                title: "ç¬¬2ç¯‡",
                scripture: "å¤ªä¸€18ï½25",
                verses: "ç‹çš„å®¶ä¸–èˆ‡èº«åˆ†ï¼ˆäºŒï¼‰",
                content: "å››ã€äºä¼¯æ‹‰ç½•\né¦¬å¤ªç¦éŸ³çš„å®¶è­œé–‹å§‹æ–¼äºä¼¯æ‹‰ç½•ï¼Œä½†è·¯åŠ ç¦éŸ³çš„å®¶è­œå»å›æº¯åˆ°äºç•¶ã€‚é¦¬å¤ªæ²’æœ‰é¡Œåˆ°äºç•¶å’Œä»–çš„å¾Œè£”ï¼Œè·¯åŠ å»æœ‰ã€‚é€™å€‹å·®åˆ¥æœ‰ç”šéº¼æ„æ€ï¼Ÿè·¯åŠ ç¦éŸ³æ˜¯èªªåˆ°ç¥æ•‘æ©çš„æ›¸ï¼Œè€Œé¦¬å¤ªç¦éŸ³æ˜¯èªªåˆ°åœ‹åº¦çš„æ›¸ã€‚\n\nç¥çš„åœ‹ä¹ƒæ˜¯ç‚ºè‘—é€™å€‹æ—é¡ï¼Œç¥çš„åœ‹æ°¸é ä¸èƒ½åœ¨å¢®è½çš„æ—é¡èº«ä¸Šã€‚å› æ­¤ï¼Œè«–åˆ°è«¸å¤©ä¹‹åœ‹çš„é¦¬å¤ªç¦éŸ³ï¼Œå°±ä»¥äºä¼¯æ‹‰ç½•é–‹å§‹ã€‚\n\näºä¼¯æ‹‰ç½•ä¹ƒæ˜¯è’™ç¥å‘¼å¬å‡ºä¾†çš„ã€‚å¬æœƒåœ¨å¸Œè‡˜æ–‡ä¹ƒæ˜¯ekklesiaï¼Œè‰¾å…‹åˆ©è¥¿äºï¼Œæ„å¬å‡ºä¾†çš„äººã€‚å› æ­¤ï¼Œæˆ‘å€‘åœ¨å¬æœƒä¸­ä¹Ÿæ˜¯å¬å‡ºä¾†çš„äººã€‚\n\näº”ã€å¤§è¡›\né¦¬å¤ªç¦éŸ³çš„å®¶è­œèªªåˆ°å¤§è¡›ã€‚å¤§è¡›ä¹‹å‰æ˜¯åˆ—ç¥–ï¼Œå¤§è¡›ä¹‹å¾Œæ˜¯å›ç‹ã€‚å¤§è¡›æ˜¯ç‹å®¤çš„å‰µå§‹äººã€‚",
                scriptureText: "å¥¹è¦ç”Ÿä¸€å€‹å…’å­ï¼Œä½ è¦çµ¦ç¥‚èµ·åå«è€¶ç©Œï¼Œå› ç¥‚è¦è¦ªè‡ªå°‡ç¥‚çš„ç™¾å§“å¾ä»–å€‘çš„ç½ªè£æ•‘å‡ºä¾†ã€‚"
            },
            {
                title: "ç¬¬3ç¯‡",
                scripture: "å¤ªäºŒ1ï½12",
                verses: "æ˜Ÿè±¡å®¶ä¾†å°‹æ±‚ä¸¦æ•¬æ‹œå¬°å­©åŸºç£",
                content: "é¦¬å¤ªäºŒç« èªªåˆ°æ˜Ÿè±¡å®¶å¾æ±æ–¹ä¾†æ•¬æ‹œå¬°å­©è€¶ç©Œã€‚ä»–å€‘çœ‹è¦‹ç¥‚çš„æ˜Ÿï¼Œå°±ä¾†åˆ°è€¶è·¯æ’’å†·ï¼Œå•èªªï¼Œé‚£ç”Ÿä¸‹ä¾†ä½œçŒ¶å¤ªäººä¹‹ç‹çš„åœ¨å“ªè£ï¼Ÿ\n\né€™é¡¯æ˜ä»–å€‘å°‹æ±‚åŸºç£ä¸æ˜¯æ†‘è‘—å‚³çµ±æˆ–æ•™è¨“ï¼Œè€Œæ˜¯æ†‘è‘—å±¬å¤©çš„ç•°è±¡ã€‚ä»–å€‘å¸¶ä¾†é»ƒé‡‘ã€ä¹³é¦™ã€æ²’è—¥ä½œç¦®ç‰©ï¼Œè¡¨å¾µåŸºç£çš„ç¥æ€§ã€ç¥‚çš„å¾©æ´»ã€ä»¥åŠç¥‚çš„å—æ­»ã€‚\n\né€™å•Ÿç¤ºå‡ºæˆ‘å€‘ä¾†æ•¬æ‹œåŸºç£ï¼Œå¿…é ˆå¸¶è‘—å°ç¥‚èº«ä½çš„èªè­˜å’Œç¶“æ­·ã€‚",
                scriptureText: "é‚£ç”Ÿä¸‹ä¾†ä½œçŒ¶å¤ªäººä¹‹ç‹çš„åœ¨å“ªè£ï¼Ÿæˆ‘å€‘åœ¨æ±æ–¹çœ‹è¦‹ç¥‚çš„æ˜Ÿï¼Œç‰¹ä¾†æ‹œç¥‚ã€‚"
            },
            {
                title: "ç¬¬4ç¯‡",
                scripture: "å¤ªäºŒ13ï½23",
                verses: "å¬°å­©è€¶ç©Œè¢«é€ƒåˆ°åŸƒåŠä¸¦è¢«å¸¶å›",
                content: "ç´„ç‘Ÿå¸¶è‘—é¦¬åˆ©äºå’Œè€¶ç©Œé€ƒå¾€åŸƒåŠï¼Œç‚ºè¦èº²é¿å¸Œå¾‹çš„æ®ºå®³ã€‚é€™æ‡‰é©—äº†ä¸»è—‰è‘—å…ˆçŸ¥æ‰€èªªçš„ï¼Œæˆ‘å¾åŸƒåŠå¬å‡ºæˆ‘çš„å…’å­ä¾†ã€‚\n\nå¾Œä¾†å¸Œå¾‹æ­»äº†ï¼Œç´„ç‘Ÿå¸¶è‘—å­©å­å’Œç¥‚æ¯è¦ªå›åˆ°ä»¥è‰²åˆ—åœ°ï¼Œä½†å› äºåŸºè€æ¥çºŒä»–çˆ¶è¦ªå¸Œå¾‹ä½œäº†çŒ¶å¤ªç‹ï¼Œå°±å®³æ€•å¾€é‚£è£å»ã€‚æ–¼æ˜¯å¾€åŠ åˆ©åˆ©å¢ƒå…§å»ï¼Œä½åœ¨æ‹¿æ’’å‹’ã€‚\n\né€™å°±æ‡‰é©—äº†çœ¾å…ˆçŸ¥æ‰€èªªçš„ï¼Œç¥‚è¦ç¨±ç‚ºæ‹¿æ’’å‹’äººã€‚",
                scriptureText: "ä½åœ¨é‚£è£ï¼Œç›´åˆ°å¸Œå¾‹æ­»äº†ã€‚é€™æ˜¯è¦æ‡‰é©—ä¸»è—‰è‘—å…ˆçŸ¥æ‰€èªªçš„ï¼Œæˆ‘å¾åŸƒåŠå¬å‡ºæˆ‘çš„å…’å­ä¾†ã€‚"
            },
            {
                title: "ç¬¬5ç¯‡",
                scripture: "å¤ªä¸‰1ï½12",
                verses: "å…ˆé‹’çš„è·äº‹â”€é–‹è·¯ä¸¦å¼•é€²ç‹",
                content: "ä¸‰ç« ä¸€ç¯€èªªåˆ°æ™‚å€™æ»¿è¶³äº†ï¼Œé‚£æ™‚å€™ï¼Œæ–½æµ¸è€…ç´„ç¿°å‡ºä¾†ï¼Œåœ¨çŒ¶å¤ªçš„æ› é‡å‚³é“ï¼Œèªªï¼Œä½ å€‘è¦æ‚”æ”¹ï¼Œå› ç‚ºè«¸å¤©çš„åœ‹å·²ç¶“è‡¨è¿‘äº†ã€‚\n\nç´„ç¿°æ˜¯ä¸»çš„å…ˆé‹’ï¼Œä»–çš„è·äº‹æ˜¯ç‚ºä¸»é–‹è·¯ï¼Œå°‡äººå¼•é€²åœ‹åº¦ã€‚ä»–ç©¿é§±é§æ¯›çš„è¡£æœï¼Œè…°æŸçš®å¸¶ï¼Œåƒè—èŸ²é‡èœœï¼Œéè‘—å¦èªå·±çš„ç”Ÿæ´»ã€‚\n\nä»–å°æ³•åˆ©è³½äººå’Œæ’’éƒ½è©²äººèªªï¼Œæ¯’è›‡ä¹‹ç¨®ï¼Œèª°æŒ‡ç¤ºä½ å€‘é€ƒé¿è¦ä¾†çš„å¿¿æ€’ï¼Ÿä½ å€‘è¦çµå‡ºæœå­ï¼Œèˆ‡æ‚”æ”¹ç›¸ç¨±ã€‚",
                scriptureText: "ä½ å€‘è¦æ‚”æ”¹ï¼Œå› ç‚ºè«¸å¤©çš„åœ‹å·²ç¶“è‡¨è¿‘äº†ã€‚"
            }
        ];

        // è¨­å®š
        var settings = {
            startDate: '2025-01-06',
            currentWeek: 1
        };

        // è¼‰å…¥è¨­å®š
        function loadSettings() {
            try {
                var saved = localStorage.getItem('matthewLifeStudySettings');
                if (saved) {
                    settings = JSON.parse(saved);
                }
                document.getElementById('startDateInput').value = settings.startDate;
            } catch (e) {
                console.error('è¼‰å…¥è¨­å®šå¤±æ•—:', e);
            }
        }

        // å„²å­˜è¨­å®š
        function saveSettings() {
            try {
                localStorage.setItem('matthewLifeStudySettings', JSON.stringify(settings));
            } catch (e) {
                console.error('å„²å­˜è¨­å®šå¤±æ•—:', e);
            }
        }

        // è¨ˆç®—ç•¶å‰æ˜¯ç¬¬å¹¾é€±
        function getCurrentWeek() {
            var startDate = new Date(settings.startDate);
            var now = new Date();
            var diffTime = now - startDate;
            var diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            var diffWeeks = Math.floor(diffDays / 7) + 1;
            return Math.max(1, diffWeeks);
        }

        // è¨ˆç®—ç•¶å‰æ‡‰è©²é¡¯ç¤ºçš„è®€ç¶“ç´¢å¼•å’Œåˆ†æ®µ
        function getCurrentReading() {
            var currentWeek = getCurrentWeek();
            settings.currentWeek = currentWeek;
            
            var readingIndex = Math.floor((currentWeek - 1) / 2);
            var part = ((currentWeek - 1) % 2 === 0) ? 1 : 2;
            
            return {
                readingIndex: Math.min(readingIndex, readings.length - 1),
                part: part,
                week: currentWeek
            };
        }

        // åˆ†å‰²å…§å®¹ç‚ºå…©åŠ
        function splitContent(content) {
            var paragraphs = content.split('\n\n').filter(function(p) { return p.trim(); });
            var midPoint = Math.ceil(paragraphs.length / 2);
            
            return {
                part1: paragraphs.slice(0, midPoint).join('\n\n'),
                part2: paragraphs.slice(midPoint).join('\n\n')
            };
        }

        // æ¸²æŸ“å…§å®¹
        function renderContent() {
            try {
                var current = getCurrentReading();
                var reading = readings[current.readingIndex];
                
                if (!reading) {
                    document.getElementById('contentText').textContent = 'æ‰€æœ‰è®€ç¶“å·²å®Œæˆï¼é¡˜ä¸»ç¥ç¦ä½ ã€‚';
                    return;
                }

                // æ›´æ–°é€±è³‡è¨Š
                document.getElementById('weekInfo').textContent = 'ç¬¬ ' + current.week + ' é€±';
                
                // æ›´æ–°æ¨™é¡Œ
                document.getElementById('readingTitle').textContent = reading.title;
                document.getElementById('readingMeta').textContent = reading.scripture + ' | ' + reading.verses;
                
                // æ›´æ–°åˆ†æ®µæŒ‡ç¤ºå™¨
                var partText = current.part === 1 ? 'ç¬¬ä¸€éƒ¨åˆ†' : 'ç¬¬äºŒéƒ¨åˆ†';
                document.getElementById('partIndicator').textContent = partText;
                
                // åˆ†å‰²å…§å®¹
                var parts = splitContent(reading.content);
                var content = current.part === 1 ? parts.part1 : parts.part2;
                
                // å°‡æ®µè½è½‰ç‚ºHTML
                var paragraphs = content.split('\n\n').map(function(p) {
                    return '<p style="margin-bottom: 15px; text-indent: 2em;">' + p + '</p>';
                }).join('');
                document.getElementById('contentText').innerHTML = paragraphs;
                
                // æ›´æ–°ç¶“æ–‡
                document.getElementById('scriptureText').textContent = reading.scriptureText;
                document.getElementById('scriptureRef').textContent = 'â€” ' + reading.scripture;
                
                // æ›´æ–°é€²åº¦æ¢
                var totalReadings = readings.length * 2;
                var completedWeeks = current.week - 1;
                var progress = (completedWeeks / totalReadings) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('progressText').textContent = 'ç¸½é€²åº¦: ' + completedWeeks + '/' + totalReadings + ' (' + Math.round(progress) + '%)';
                
                // æ›´æ–°å°èˆªæŒ‰éˆ•
                document.getElementById('prevBtn').disabled = current.week <= 1;
                document.getElementById('nextBtn').disabled = current.readingIndex >= readings.length - 1 && current.part === 2;
                
                console.log('æ¸²æŸ“å®Œæˆ:', reading.title);
            } catch (e) {
                console.error('æ¸²æŸ“å¤±æ•—:', e);
                document.getElementById('contentText').textContent = 'è¼‰å…¥å¤±æ•—ï¼Œè«‹åˆ·æ–°é é¢é‡è©¦ã€‚';
            }
        }

        // å€’æ•¸è¨ˆæ™‚åˆ°ä¸‹å€‹é€±ä¸€
        function updateCountdown() {
            try {
                var now = new Date();
                var nextMonday = new Date(now);
                nextMonday.setDate(now.getDate() + (1 + 7 - now.getDay()) % 7);
                nextMonday.setHours(0, 0, 0, 0);
                
                if (now.getDay() === 1 && now.getHours() >= 0) {
                    nextMonday.setDate(nextMonday.getDate() + 7);
                }
                
                var diff = nextMonday - now;
                var days = Math.floor(diff / (1000 * 60 * 60 * 24));
                var hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                
                document.getElementById('countdownTime').textContent = days + 'å¤© ' + hours + 'å°æ™‚ ' + minutes + 'åˆ†é˜';
            } catch (e) {
                console.error('å€’æ•¸è¨ˆæ™‚å¤±æ•—:', e);
            }
        }

        // å°èˆªåŠŸèƒ½
        document.getElementById('prevBtn').addEventListener('click', function() {
            var current = getCurrentReading();
            if (current.week > 1) {
                var startDate = new Date(settings.startDate);
                var prevWeekDate = new Date(startDate);
                prevWeekDate.setDate(startDate.getDate() + (current.week - 2) * 7);
                
                var originalStartDate = settings.startDate;
                settings.startDate = prevWeekDate.toISOString().split('T')[0];
                renderContent();
                settings.startDate = originalStartDate;
            }
        });

        document.getElementById('nextBtn').addEventListener('click', function() {
            var current = getCurrentReading();
            var startDate = new Date(settings.startDate);
            var nextWeekDate = new Date(startDate);
            nextWeekDate.setDate(startDate.getDate() + current.week * 7);
            
            var originalStartDate = settings.startDate;
            settings.startDate = nextWeekDate.toISOString().split('T')[0];
            renderContent();
            settings.startDate = originalStartDate;
        });

        // è¨­å®šåŠŸèƒ½
        document.getElementById('settingsBtn').addEventListener('click', function() {
            document.getElementById('settingsModal').classList.add('active');
            renderReadingList();
        });

        document.getElementById('closeSettingsBtn').addEventListener('click', function() {
            document.getElementById('settingsModal').classList.remove('active');
        });

        document.getElementById('startDateInput').addEventListener('change', function() {
            settings.startDate = this.value;
            saveSettings();
            renderContent();
        });

        function renderReadingList() {
            var list = document.getElementById('readingList');
            var current = getCurrentReading();
            var html = '';
            
            for (var i = 0; i < readings.length; i++) {
                var week1 = i * 2 + 1;
                var week2 = i * 2 + 2;
                var isCurrent = i === current.readingIndex;
                var isCompleted = week2 < current.week;
                
                html += '<div class="reading-item ' + (isCurrent ? 'current' : '') + ' ' + (isCompleted ? 'completed' : '') + '" data-week="' + week1 + '" style="padding: 10px; border-bottom: 1px solid #f0f0f0; cursor: pointer;">' +
                    readings[i].title + ' - ç¬¬' + week1 + '-' + week2 + 'é€±' +
                    (isCompleted ? ' âœ“' : '') +
                    '</div>';
            }
            list.innerHTML = html;
            
            // æ·»åŠ é»æ“Šäº‹ä»¶
            var items = list.querySelectorAll('.reading-item');
            for (var j = 0; j < items.length; j++) {
                items[j].addEventListener('click', function() {
                    var week = parseInt(this.getAttribute('data-week'));
                    jumpToWeek(week);
                });
            }
        }

        function jumpToWeek(week) {
            var startDate = new Date(settings.startDate);
            var targetDate = new Date(startDate);
            targetDate.setDate(startDate.getDate() + (week - 1) * 7);
            
            settings.startDate = targetDate.toISOString().split('T')[0];
            document.getElementById('startDateInput').value = settings.startDate;
            saveSettings();
            renderContent();
            document.getElementById('settingsModal').classList.remove('active');
        }

        // åˆå§‹åŒ–
        console.log('é–‹å§‹åˆå§‹åŒ–...');
        loadSettings();
        renderContent();
        updateCountdown();
        setInterval(updateCountdown, 60000);
        console.log('åˆå§‹åŒ–å®Œæˆ');
        
    } catch (error) {
        console.error('åˆå§‹åŒ–å¤±æ•—:', error);
        document.body.innerHTML = '<div style="padding: 20px; text-align: center; color: white;"><h1>è¼‰å…¥å¤±æ•—</h1><p>è«‹åˆ·æ–°é é¢é‡è©¦</p></div>';
    }
});
    </script>
</body>
</html>
